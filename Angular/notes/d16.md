# Day 16: Angular Architecture - CLI, Project Structure, and Standalone Components

## What is Angular?

**Angular** is a **complete framework** for building dynamic, single-page applications (SPAs). It provides:

- **Component-based architecture:** Reusable, composable UI pieces
- **Dependency Injection:** Loose coupling and testability
- **Reactivity:** Automatic UI updates when data changes
- **Routing:** Client-side navigation
- **Forms:** Template-driven and reactive forms
- **HTTP Client:** Easy API communication
- **TypeScript Support:** Full type safety

---

## Angular CLI: Setup and Generation

The **Angular CLI** (Command Line Interface) is your primary tool for creating and managing Angular projects.

### Creating a New Angular Project

```bash
# Create new project
ng new my-app

# Navigate to project
cd my-app

# Run development server
ng serve
# Or with auto-reload on changes
ng serve --watch

# Build for production
ng build

# Run unit tests
ng test

# Run end-to-end tests
ng e2e
```

### Generating Components, Services, etc.

```bash
# Generate component
ng generate component components/header
ng g c components/header  # Short syntax

# Generate service
ng generate service services/user
ng g s services/user

# Generate module
ng generate module shared/shared.module

# Generate pipe
ng generate pipe pipes/custom-pipe

# Generate guard
ng generate guard guards/auth.guard

# Generate interceptor
ng generate interceptor interceptors/auth.interceptor

# Generate directive
ng generate directive directives/highlight

# Generate interface
ng generate interface models/User
```

---

## Project Structure (Modern Angular)

With **Standalone Components** (Angular 14+), the structure is simpler:

```
src/
├── app/
│   ├── components/
│   │   ├── header/
│   │   │   ├── header.component.ts
│   │   │   ├── header.component.html
│   │   │   └── header.component.css
│   │   ├── sidebar/
│   │   │   ├── sidebar.component.ts
│   │   │   ├── sidebar.component.html
│   │   │   └── sidebar.component.css
│   │   └── footer/
│   │       └── ...
│   ├── pages/
│   │   ├── home/
│   │   │   └── home.component.ts
│   │   ├── about/
│   │   │   └── about.component.ts
│   │   └── not-found/
│   │       └── not-found.component.ts
│   ├── services/
│   │   ├── user.service.ts
│   │   ├── task.service.ts
│   │   └── api.service.ts
│   ├── models/
│   │   ├── user.model.ts
│   │   ├── task.model.ts
│   │   └── api-response.model.ts
│   ├── guards/
│   │   ├── auth.guard.ts
│   │   └── admin.guard.ts
│   ├── interceptors/
│   │   └── auth.interceptor.ts
│   ├── pipes/
│   │   └── custom.pipe.ts
│   ├── directives/
│   │   └── highlight.directive.ts
│   ├── app.component.ts
│   ├── app.config.ts
│   ├── app.routes.ts
│   └── main.ts
├── assets/
│   └── (images, icons, etc.)
├── styles.css
├── index.html
└── main.ts
```

---

## Standalone Components (Modern Approach)

**Standalone components** are the modern way to build Angular apps. They don't require NgModules for most use cases.

### Basic Standalone Component

```typescript
// app/components/header/header.component.ts
import { Component } from "@angular/core";
import { CommonModule } from "@angular/common";

@Component({
  selector: "app-header",
  standalone: true,
  imports: [CommonModule], // Import dependencies here
  template: `
    <header>
      <h1>{{ title }}</h1>
      <nav>
        <a href="/home">Home</a>
        <a href="/about">About</a>
      </nav>
    </header>
  `,
  styles: [
    `
      header {
        background: #f0f0f0;
        padding: 1rem;
      }
    `,
  ],
})
export class HeaderComponent {
  title = "My App";
}
```

### Key Decorators

1. **@Component:** Defines a component

   - `selector`: HTML tag name
   - `standalone`: Marks as standalone
   - `imports`: Dependencies (other components, pipes, directives)
   - `template` or `templateUrl`: HTML
   - `styles` or `styleUrls`: CSS

2. **@Input:** Pass data from parent to child
3. **@Output:** Emit events from child to parent
4. **@Injectable:** Mark class as service

---

## App Configuration

### app.config.ts (Modern Bootstrap)

```typescript
// app/app.config.ts
import { ApplicationConfig, importProvidersFrom } from "@angular/core";
import { provideRouter } from "@angular/router";
import { provideHttpClient, withInterceptors } from "@angular/common/http";

import { APP_ROUTES } from "./app.routes";
import { authInterceptor } from "./interceptors/auth.interceptor";

export const appConfig: ApplicationConfig = {
  providers: [
    provideRouter(APP_ROUTES),
    provideHttpClient(withInterceptors([authInterceptor])),
    // Add other providers here
  ],
};
```

### main.ts (Application Bootstrap)

```typescript
// main.ts
import { bootstrapApplication } from "@angular/platform-browser";
import { appConfig } from "./app/app.config";
import { AppComponent } from "./app/app.component";

bootstrapApplication(AppComponent, appConfig).catch((err) =>
  console.error(err)
);
```

---

## Basic Components

### Component with Template File

```typescript
// app/components/task-list/task-list.component.ts
import { Component, OnInit } from "@angular/core";
import { CommonModule } from "@angular/common";
import { Task } from "../../models/task.model";

@Component({
  selector: "app-task-list",
  standalone: true,
  imports: [CommonModule],
  templateUrl: "./task-list.component.html",
  styleUrls: ["./task-list.component.css"],
})
export class TaskListComponent implements OnInit {
  tasks: Task[] = [];
  loading = true;

  ngOnInit(): void {
    this.loadTasks();
  }

  loadTasks(): void {
    this.tasks = [
      { id: 1, title: "Learn Angular", completed: false },
      { id: 2, title: "Build App", completed: true },
    ];
    this.loading = false;
  }
}
```

```html
<!-- task-list.component.html -->
<div class="task-list">
  <h2>Tasks</h2>

  <div *ngIf="loading" class="loading">Loading tasks...</div>

  <ul *ngIf="!loading">
    <li *ngFor="let task of tasks" [class.completed]="task.completed">
      {{ task.title }}
    </li>
  </ul>
</div>
```

---

## Services and Dependency Injection

### Creating a Service

```typescript
// app/services/task.service.ts
import { Injectable } from "@angular/core";
import { HttpClient } from "@angular/common/http";
import { Observable } from "rxjs";
import { Task } from "../models/task.model";

@Injectable({
  providedIn: "root", // Singleton service
})
export class TaskService {
  private apiUrl = "http://localhost:3000/api/tasks";

  constructor(private http: HttpClient) {}

  getTasks(): Observable<Task[]> {
    return this.http.get<Task[]>(this.apiUrl);
  }

  getTaskById(id: number): Observable<Task> {
    return this.http.get<Task>(`${this.apiUrl}/${id}`);
  }

  createTask(task: Task): Observable<Task> {
    return this.http.post<Task>(this.apiUrl, task);
  }

  updateTask(id: number, task: Task): Observable<Task> {
    return this.http.put<Task>(`${this.apiUrl}/${id}`, task);
  }

  deleteTask(id: number): Observable<void> {
    return this.http.delete<void>(`${this.apiUrl}/${id}`);
  }
}
```

### Using a Service in a Component

```typescript
// app/components/task-list/task-list.component.ts
import { Component, OnInit } from "@angular/core";
import { CommonModule } from "@angular/common";
import { TaskService } from "../../services/task.service";
import { Task } from "../../models/task.model";

@Component({
  selector: "app-task-list",
  standalone: true,
  imports: [CommonModule],
  templateUrl: "./task-list.component.html",
})
export class TaskListComponent implements OnInit {
  tasks: Task[] = [];
  loading = true;
  error: string | null = null;

  // Dependency Injection: Angular automatically provides TaskService
  constructor(private taskService: TaskService) {}

  ngOnInit(): void {
    this.loadTasks();
  }

  loadTasks(): void {
    this.taskService.getTasks().subscribe({
      next: (data) => {
        this.tasks = data;
        this.loading = false;
      },
      error: (err) => {
        this.error = "Failed to load tasks";
        this.loading = false;
        console.error(err);
      },
    });
  }
}
```

---

## Routing Setup

### app.routes.ts

```typescript
// app/app.routes.ts
import { Routes } from "@angular/router";
import { HomeComponent } from "./pages/home/home.component";
import { AboutComponent } from "./pages/about/about.component";
import { TaskListComponent } from "./components/task-list/task-list.component";
import { NotFoundComponent } from "./pages/not-found/not-found.component";

export const APP_ROUTES: Routes = [
  { path: "", redirectTo: "/home", pathMatch: "full" },
  { path: "home", component: HomeComponent },
  { path: "about", component: AboutComponent },
  { path: "tasks", component: TaskListComponent },
  { path: "**", component: NotFoundComponent }, // Catch-all (must be last)
];
```

### Root Component

```typescript
// app/app.component.ts
import { Component } from "@angular/core";
import { RouterLink, RouterOutlet } from "@angular/router";

@Component({
  selector: "app-root",
  standalone: true,
  imports: [RouterLink, RouterOutlet],
  template: `
    <nav>
      <a routerLink="/home">Home</a>
      <a routerLink="/about">About</a>
      <a routerLink="/tasks">Tasks</a>
    </nav>

    <main>
      <router-outlet></router-outlet>
    </main>
  `,
  styles: [
    `
      nav {
        background: #333;
        color: white;
        padding: 1rem;
      }
      a {
        color: white;
        margin-right: 1rem;
        text-decoration: none;
      }
    `,
  ],
})
export class AppComponent {
  title = "Task App";
}
```

---

## Component Communication

### Parent to Child: @Input

```typescript
// Child component
@Component({
  selector: "app-task-item",
  standalone: true,
  template: `<div>{{ task.title }}</div>`,
})
export class TaskItemComponent {
  @Input() task!: Task;
}

// Parent component
@Component({
  template: ` <app-task-item [task]="currentTask"></app-task-item> `,
})
export class TaskListComponent {
  currentTask: Task = { id: 1, title: "Learn Angular" };
}
```

### Child to Parent: @Output

```typescript
// Child component
@Component({
  selector: "app-task-input",
  standalone: true,
  template: `
    <input [(ngModel)]="taskTitle" />
    <button (click)="addTask()">Add</button>
  `,
})
export class TaskInputComponent {
  taskTitle = "";
  @Output() taskAdded = new EventEmitter<string>();

  addTask(): void {
    if (this.taskTitle) {
      this.taskAdded.emit(this.taskTitle);
      this.taskTitle = "";
    }
  }
}

// Parent component
@Component({
  template: `
    <app-task-input (taskAdded)="onTaskAdded($event)"></app-task-input>
  `,
})
export class TaskListComponent {
  onTaskAdded(title: string): void {
    console.log("New task:", title);
  }
}
```

---

## Lifecycle Hooks

```typescript
import { Component, OnInit, OnDestroy } from '@angular/core';

@Component({...})
export class MyComponent implements OnInit, OnDestroy {

  // Called once after first ngOnInit
  ngOnInit(): void {
    console.log('Component initialized');
  }

  // Called before component is destroyed
  ngOnDestroy(): void {
    console.log('Component destroyed - cleanup here');
  }
}
```

---

## Summary

- **Angular** is a complete framework for building SPAs
- **Standalone Components** are the modern approach (no NgModules needed for most cases)
- **CLI** automates project setup and code generation
- **Services** handle business logic and API communication
- **Dependency Injection** makes code testable and loosely coupled
- **Routing** enables client-side navigation
- **Component Communication** via @Input/@Output
- **Lifecycle Hooks** allow you to hook into component lifecycle events
